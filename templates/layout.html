<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Global News Hub</title>

    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/output.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />

    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='img/miniLogo.png') }}">
  </head>
  <body class="bg-light-main-bg dark:bg-dark-main-bg transition-colors">
    <div
      class="flex justify-center bg-gradient-to-r from-purple-500 to-purple-200 py-2"
    >
      <a href="{{ url_for('home') }}"
        ><img src={{url_for('static', filename='img/logo.png')}} class="w-[200px]"
      /></a>
    </div>
    <header
      class="sticky top-0 z-50 bg-light-header-bg text-light-header-text dark:text-dark-header-text dark:bg-dark-header-bg"
    >
    <div class="max-w-7xl mx-auto px-10 py-3 md:p-3 flex justify-between relative">
        <button class="md:hidden" onclick='toggleMainNavbar()'>
          <i class="fa-solid fa-bars"></i>
        </button>
        <nav id='mobile-nav' class="hidden absolute w-[90%] {%  if lang == 'ar' %} right-0 {% else %} left-0 {%endif%} top-full flex flex-col gap-3 p-4 bg-light-header-bg dark:bg-dark-header-bg  ">
          <a href="/category/world?lang={{ lang }}">
            <img src={{url_for('static', filename='img/miniLogo.png')}} class="w-[100px]" />
          </a>
          <a href="/category/world?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.world}}
          </a>
          <a href="/category/sports?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.sports}}
          </a>
          <a href="/category/politics?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.politics}}
          </a>
          <a href="/category/technology?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.technology}}
          </a>
          <a href="/category/entertainment?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.entertainment}}
          </a>
          <a href="/category/business?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.business}}
          </a>
          <a href="/category/health?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.health}}
          </a>
          <a href="/category/science?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.science}}
          </a>
          <a href="/category/travel?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.travel}}
          </a>
        </nav>
        <nav class="desktop-nav hidden md:flex gap-10 ">
          <a href="/category/world?lang={{ lang }}">
            <img src={{url_for('static', filename='img/miniLogo.png')}} class="w-[100px]" />
          </a>
          <a href="/category/world?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.world}}
          </a>
          <a href="/category/sports?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.sports}}
          </a>
          <a href="/category/politics?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.politics}}
          </a>
          <a href="/category/technology?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.technology}}
          </a>
          <a href="/category/entertainment?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.entertainment}}
          </a>
          <a href="/category/business?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.business}}
          </a>
          <a href="/category/health?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.health}}
          </a>
          <a href="/category/science?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.science}}
          </a>
          <a href="/category/travel?lang={{ lang }}"
            class="hover:text-yellow-300 dark:hover:text-yellow-400 transition-colors">
            {{t.travel}}
          </a>
        </nav>
        <div class="flex gap-3 relative">
          <button onclick="toggleMenu()">
            <i class="fa-solid fa-language"></i>
          </button>
          <div class="absolute top-full">
            <select
              id="languagesList"
              class="hidden bg-purple-600 p-1 focus:outline-none"
            >
              <option value="en" {% if lang == 'en'%}selected{%endif%}>{{t.lang_english}}</option>
              <option value="fr" {% if lang == 'fr'%}selected{%endif%}>{{t.lang_french}}</option>
              <option value="es" {% if lang == 'es'%}selected{%endif%}>{{t.lang_spanish}}</option>
              <option value="de" {% if lang == 'de'%}selected{%endif%}>{{t.lang_german}}</option>
              <option value="ar" {% if lang == 'ar'%}selected{%endif%}>{{t.lang_arabic}}</option>
            </select>
          </div>
          <button id="toggleDarkMode" onclick="toggleDarkMode()">
            <i class="fa-regular fa-moon"></i>
          </button>
        </div>
      </div>
    </header>
    <form
      action="{{ url_for('home') }}"
      method="get"
      class="flex justify-center my-4"
    >
      <div class="w-[70%] lg:w-[700px] relative">
        <input
          type="text"
          name="q"
          placeholder={{t.search_placeholder}}
          value="{{ t.get(query) if t.get(query) else query }}"
          class="w-full border border-purple-600 rounded-l-lg p-2 pl-4 focus:outline-none focus:ring-1 focus:ring-blue-400"
        />
        <input type="hidden" name="lang" value="{{ lang|default('en') }}" />
        <button
          type="submit"
          class="h-[42px] absolute right-0 top-1/2 -translate-y-1/2 translate-x-full bg-purple-600 rounded-r-lg px-3 hover:scale-[1.05] transition-transform"
        >
          <i class="fa-solid fa-magnifying-glass text-white"></i>
        </button>
      </div>
    </form>

    <main class="max-w-[1370px] mx-auto text-light-text-primary dark:text-dark-text-primary">
      {% block content %}{% endblock %}
    </main>

    <footer class="bg-light-button-footer-bg dark:bg-dark-footer-bg text-light-footer-text dark:text-dark-footer-text mt-16 border border-gray-200 dark:border-gray-700">
      <div class="max-w-7xl mx-auto px-4 py-8">  
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
          <div>
            <h3 class="font-bold text-lg mb-4">{{t.site_title}}</h3>
            <p class="text-sm text-light-text-secondary dark:text-dark-text-secondary">{{t.footer_about}}</p>
          </div>
          <div>
            <h4 class="font-bold mb-4">{{t.categories}}</h4>
            <ul class="space-y-2 text-sm">
              <li><a href="/category/world?lang={{lang}}" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.world}}</a></li>
              <li><a href="/category/sports?lang={{lang}}" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.sports}}</a></li>
              <li><a href="/category/business?lang={{lang}}" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.business}}</a></li>
              <li><a href="/category/technology?lang={{lang}}" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.technology}}</a></li>
            </ul>
          </div>
          
          <div>
            <h4 class="font-bold mb-4">{{t.quick_links}}</h4>
            <ul class="space-y-2 text-sm">
              <li><a href="{{url_for('home')}}" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.home}}</a></li>
              <li><a href="/category/entertainment?lang={{lang}}" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.entertainment}}</a></li>
              <li><a href="/category/health?lang={{lang}}" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.health}}</a></li>
              <li><a href="/category/science?lang={{lang}}" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.science}}</a></li>
            </ul>
          </div>
          
          <div>
            <h4 class="font-bold mb-4">{{t.languages}}</h4>
            <ul class="space-y-2 text-sm">
              <li><a onclick="localStorage.setItem('lang', 'en')" href="?lang=en" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.lang_english}}</a></li>
              <li><a onclick="localStorage.setItem('lang', 'ar')" href="?lang=ar" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.lang_arabic}}</a></li>
              <li><a onclick="localStorage.setItem('lang', 'es')" href="?lang=es" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.lang_spanish}}</a></li>
              <li><a onclick="localStorage.setItem('lang', 'fr')" href="?lang=fr" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.lang_french}}</a></li>
              <li><a onclick="localStorage.setItem('lang', 'de')" href="?lang=de" class="hover:text-light-header-bg dark:hover:text-dark-header-bg">{{t.lang_german}}</a></li>
            </ul>
          </div>
          
        </div>
        <div class="border-t border-gray-300 dark:border-gray-700 pt-6">
          <div class="flex flex-col md:flex-row justify-between items-center">
            <p class="text-sm text-light-text-secondary dark:text-dark-text-secondary mb-4 md:mb-0">{{t.copyright}}</p>
            <div class="flex gap-6">
              <a href="#" class="hover:text-black transition-colors"><i class='fab fa-x'></i></a>
              <a href="#" class="hover:text-[#1877f2] transition-colors"><i class='fab fa-facebook'></i></a>
              <a href="#" class="hover:text-[#c13584] transition-colors"><i class='fab fa-instagram'></i></a>
              <a href="#" class="hover:text-[#0077b5] transition-colors"><i class='fab fa-linkedin'></i></a>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <script>
      let isVisible = false;
      let isToggled = false
      const menu = document.getElementById("languagesList");
      const url = new URL(window.location.href);
      
      // load stored language from localStorage
      const storedLang = localStorage.getItem('lang')
      if(storedLang) {
        menu.value = storedLang;
        document.documentElement.dir = storedLang === 'ar' ?  'rtl' : 'ltr'
      }
      else {
          document.documentElement.dir = 'ltr'
      }

      if(storedLang && url.searchParams.get('lang') !== storedLang) {
        url.searchParams.set('lang', storedLang)
        window.location.href = url.toString()
      }
      // load theme from localStorage
      if (localStorage.getItem("theme") === "dark") {
        document.documentElement.classList.add("dark");
      }


    

      function updateIcon() {
        const btn = document.getElementById("toggleDarkMode");

        if (document.documentElement.classList.contains("dark")) {
          btn.innerHTML = '<i class="fa-regular fa-sun"></i>';
        } else {
          btn.innerHTML = '<i class="fa-regular fa-moon"></i>';
        }
      }

      updateIcon();

      function toggleDarkMode() {
        document.documentElement.classList.toggle("dark");

        if (document.documentElement.classList.contains("dark")) {
          localStorage.setItem("theme", "dark");
        } else {
          localStorage.setItem("theme", "light");
        }
        updateIcon();
      }

      function toggleMenu() {
        isVisible = !isVisible;
        if (isVisible) {
          menu.style.display = "block";
        } else {
          menu.style.display = "none";
        }
      }

      menu.addEventListener("change", () => {
        const lang = menu.value;
        localStorage.setItem('lang', lang)
        const url = new URL(window.location.href);
        url.searchParams.set("lang", lang);
        window.location.href = url.toString();
        
      });

      function toggleMainNavbar() {
        isToggled = !isToggled
        const navbar = document.getElementById('mobile-nav')
        if(isToggled) {
          navbar.style.display = 'flex'
        }
        else {
          navbar.style.display = 'none'
        }
      }

    </script>
  </body>
</html>
